"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ColumnManager=function(e){this.table=e,this.headersElement=$("<div class='tabulator-headers'></div>"),this.element=$("<div class='tabulator-header'></div>"),this.rowManager=null,this.columns=[],this.columnsByIndex=[],this.columnsByField=[],this.scrollLeft=0,this.element.prepend(this.headersElement)};ColumnManager.prototype.setRowManager=function(e){this.rowManager=e},ColumnManager.prototype.getElement=function(){return this.element},ColumnManager.prototype.getHeadersElement=function(){return this.headersElement},ColumnManager.prototype.scrollHorizontal=function(e){var t=0,n=this.element[0].scrollWidth-this.table.element.innerWidth();this.element.scrollLeft(e),e>n?(t=e-n,this.element.css("margin-left",-t)):this.element.css("margin-left",0),this.scrollLeft=e,this.table.extExists("frozenColumns")&&this.table.extensions.frozenColumns.layout()},ColumnManager.prototype.setColumns=function(e,t){var n=this;n.headersElement.empty(),n.columns=[],n.columnsByIndex=[],n.columnsByField=[],n.table.extExists("frozenColumns")&&n.table.extensions.frozenColumns.reset(),e.forEach(function(e,t){n._addColumn(e)}),n._reIndexColumns(),n.table.options.responsiveLayout&&n.table.extExists("responsiveLayout",!0)&&n.table.extensions.responsiveLayout.initialize(),n.redraw(!0)},ColumnManager.prototype._addColumn=function(e,t,n){var o=new Column(e,this),i=n?this.findColumnIndex(n):n;if(n&&i>-1){var s=this.columns.indexOf(n.getTopColumn());t?(this.columns.splice(s,0,o),n.getElement().before(o.getElement())):(this.columns.splice(s+1,0,o),n.getElement().after(o.getElement()))}else t?(this.columns.unshift(o),this.headersElement.prepend(o.getElement())):(this.columns.push(o),this.headersElement.append(o.getElement()));return o},ColumnManager.prototype.registerColumnField=function(e){e.definition.field&&(this.columnsByField[e.definition.field]=e)},ColumnManager.prototype.registerColumnPosition=function(e){this.columnsByIndex.push(e)},ColumnManager.prototype._reIndexColumns=function(){this.columnsByIndex=[],this.columns.forEach(function(e){e.reRegisterPosition()})},ColumnManager.prototype._verticalAlignHeaders=function(){var e=this;e.columns.forEach(function(e){e.clearVerticalAlign()}),e.columns.forEach(function(t){t.verticalAlign(e.table.options.columnVertAlign)}),e.rowManager.adjustTableSize()},ColumnManager.prototype.findColumn=function(e){var t=this;return"object"==(void 0===e?"undefined":_typeof(e))?e instanceof Column?e:e instanceof jQuery?t.columns.find(function(t){return t.element===e})||!1:e._getSelf()||!1:this.columnsByField[e]||!1},ColumnManager.prototype.getColumnByField=function(e){return this.columnsByField[e]},ColumnManager.prototype.getColumnByIndex=function(e){return this.columnsByIndex[e]},ColumnManager.prototype.getColumns=function(){return this.columns},ColumnManager.prototype.findColumnIndex=function(e){return this.columnsByIndex.findIndex(function(t){return e===t})},ColumnManager.prototype.getRealColumns=function(){return this.columnsByIndex},ColumnManager.prototype.traverse=function(e){this.columnsByIndex.forEach(function(t,n){e(t,n)})},ColumnManager.prototype.getDefinitions=function(e){var t=[];return this.columnsByIndex.forEach(function(n){(!e||e&&n.visible)&&t.push(n.getDefinition())}),t},ColumnManager.prototype.getDefinitionTree=function(){var e=[];return this.columns.forEach(function(t){e.push(t.getDefinition(!0))}),e},ColumnManager.prototype.getComponents=function(){var e=[];return this.columnsByIndex.forEach(function(t){e.push(t.getComponent())}),e},ColumnManager.prototype.getWidth=function(){var e=0;return this.columnsByIndex.forEach(function(t){t.visible&&(e+=t.getWidth())}),e},ColumnManager.prototype.moveColumn=function(e,t,n){this._moveColumnInArray(this.columns,e,t,n),this._moveColumnInArray(this.columnsByIndex,e,t,n,!0),this.table.options.columnMoved(e.getComponent()),this.table.options.persistentLayout&&this.table.extExists("persistentLayout",!0)&&this.table.extensions.persistentLayout.save()},ColumnManager.prototype._moveColumnInArray=function(e,t,n,o,i){var s,l=e.indexOf(t);l>-1&&(e.splice(l,1),(s=e.indexOf(n))>-1?o&&(s+=1):s=l,e.splice(s,0,t),i&&this.table.rowManager.rows.forEach(function(e){if(e.cells.length){var t=e.cells.splice(l,1)[0];e.cells.splice(s,0,t)}}))},ColumnManager.prototype.generateCells=function(e){var t=[];return this.columnsByIndex.forEach(function(n){t.push(n.generateCell(e))}),t},ColumnManager.prototype.fitToData=function(){this.columnsByIndex.forEach(function(e){e.reinitializeWidth()}),this.table.options.responsiveLayout&&this.table.extExists("responsiveLayout",!0)&&this.table.extensions.responsiveLayout.update()},ColumnManager.prototype.fitToTable=function(){var e=this,t=e.table.element.innerWidth(),n=0,o=0,i=0,s=[],l=0;this.table.options.responsiveLayout&&this.table.extExists("responsiveLayout",!0)&&this.table.extensions.responsiveLayout.update(),e.rowManager.element[0].scrollHeight>e.rowManager.element.innerHeight()&&(t-=e.rowManager.element[0].offsetWidth-e.rowManager.element[0].clientWidth),e.columnsByIndex.forEach(function(e){var o,i,l;e.visible&&((o=e.definition.width)?(i=parseInt(e.minWidth),l="string"==typeof o?o.indexOf("%")>-1?t/100*parseInt(o):parseInt(o):o,n+=l>i?l:i):s.push(e))}),o=t-n,i=Math.floor(o/s.length),l=t-n-i*s.length,l=l>0?l:0,s.forEach(function(e,t){var n=i>=e.minWidth?i:e.minWidth;t==s.length-1&&l&&(n+=l),e.setWidth(n)})},ColumnManager.prototype.getFlexBaseWidth=function(){var e=this,t=e.table.element.innerWidth(),n=0;return e.rowManager.element[0].scrollHeight>e.rowManager.element.innerHeight()&&(t-=e.rowManager.element[0].offsetWidth-e.rowManager.element[0].clientWidth),this.columnsByIndex.forEach(function(o){var i,s,l;o.visible&&(i=o.definition.width||0,s=void 0===o.minWidth?e.table.options.columnMinWidth:parseInt(o.minWidth),l="string"==typeof i?i.indexOf("%")>-1?t/100*parseInt(i):parseInt(i):i,n+=l>s?l:s)}),n},ColumnManager.prototype.addColumn=function(e,t,n){var o=this._addColumn(e,t,n);this._reIndexColumns(),this.table.options.responsiveLayout&&this.table.extExists("responsiveLayout",!0)&&this.table.extensions.responsiveLayout.initialize(),this.table.extExists("columnCalcs")&&this.table.extensions.columnCalcs.recalc(this.table.rowManager.displayRows),this.redraw(),this.table.options.fitColumns||o.reinitializeWidth(),this._verticalAlignHeaders(),this.table.rowManager.reinitialize()},ColumnManager.prototype.deregisterColumn=function(e){var t,n=e.getField();n&&delete this.columnsByField[n],(t=this.columnsByIndex.indexOf(e))>-1&&this.columnsByIndex.splice(t,1),(t=this.columns.indexOf(e))>-1&&this.columns.splice(t,1),this.table.options.responsiveLayout&&this.table.extExists("responsiveLayout",!0)&&this.table.extensions.responsiveLayout.initialize(),this.redraw()},ColumnManager.prototype.redraw=function(e){e&&(this.element.is(":visible")&&this._verticalAlignHeaders(),this.table.rowManager.resetScroll(),this.table.rowManager.reinitialize()),this.table.options.fitColumns?this.fitToTable():e?this.fitToData():this.table.options.responsiveLayout&&this.table.extExists("responsiveLayout",!0)&&this.table.extensions.responsiveLayout.update(),this.table.extExists("frozenColumns")&&this.table.extensions.frozenColumns.layout(),this.table.extExists("columnCalcs")&&this.table.extensions.columnCalcs.recalc(this.table.rowManager.displayRows),e&&(this.table.options.persistentLayout&&this.table.extExists("persistentLayout",!0)&&this.table.extensions.persistentLayout.save(),this.table.extExists("columnCalcs")&&this.table.extensions.columnCalcs.redraw()),this.table.footerManager.redraw()};