"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Edit=function(t){this.table=t,this.currentCell=!1};Edit.prototype.initializeColumn=function(t){var e=this,o={editor:!1,blocked:!1,check:t.definition.editable,params:t.definition.editorParams||{}};switch(_typeof(t.definition.editor)){case"string":e.editors[t.definition.editor]&&(o.editor=e.editors[t.definition.editor]);break;case"function":o.editor=t.definition.editor;break;case"boolean":!0===t.definition.editor&&"function"!=typeof t.definition.formatter&&(e.editors[t.definition.formatter]?o.editor=e.editors[t.definition.formatter]:o.editor=e.editors.input)}o.editor&&(t.extensions.edit=o)},Edit.prototype.getCurrentCell=function(){return!!this.currentCell&&this.currentCell.getComponent()},Edit.prototype.clearEditor=function(t){this.currentCell=!1,t.getElement().removeClass("tabulator-editing").empty(),t.row.getElement().removeClass("tabulator-row-editing")},Edit.prototype.bindEditor=function(t){function e(e){i.clearEditor(t),t.setValue(e,!0)}function o(){i.clearEditor(t),t.setValueActual(t.getValue()),i.table.options.cellEditCancelled(t.getComponent())}var i=this,n=t.getElement(),r=!1;n.attr("tabindex",0),n.on("click",function(t){$(this).hasClass("tabulator-editing")||$(this).focus()}),n.on("mousedown",function(t){r=!0}),n.on("focus",function(a){var s,l=function(){},c=!0;i.currentCell=t,r&&(r=!1,t.column.cellEvents.cellClick&&t.column.cellEvents.cellClick(a,t.getComponent())),t.column.extensions.edit.blocked?n.blur():(a.stopPropagation(),"function"==typeof t.column.extensions.edit.check&&(c=t.column.extensions.edit.check(t.getComponent())),c?(i.table.options.cellEditing(t.getComponent()),!1!==(s=t.column.extensions.edit.editor.call(i,t.getComponent(),function(t){l=t},e,o,t.column.extensions.edit.params))?(n.addClass("tabulator-editing"),t.row.getElement().addClass("tabulator-row-editing"),n.empty(),n.append(s),l(),n.children().click(function(t){t.stopPropagation()})):n.blur()):n.blur())})},Edit.prototype.editors={input:function(t,e,o,i,n){var r=$("<input type='text'/>");return r.css({padding:"4px",width:"100%","box-sizing":"border-box"}).val(t.getValue()),e(function(){r.focus(),r.css("height","100%")}),r.on("change blur",function(e){r.val()!=t.getValue()?o(r.val()):i()}),r.on("keydown",function(t){13==t.keyCode&&o(r.val())}),r},textarea:function(t,e,o,i,n){var r=t.getValue(),a=String("null"==typeof r||void 0===r?"":r),s=(a.match(/(?:\r\n|\r|\n)/g),$("<textarea></textarea>")),l=0;return s.css({display:"block",height:"100%",width:"100%",padding:"2px","box-sizing":"border-box","white-space":"pre-wrap",resize:"none"}).val(a),e(function(){s.focus(),s.css("height","100%")}),s.on("change blur",function(e){s.val()!=t.getValue()?(o(s.val()),setTimeout(function(){t.getRow().normalizeHeight()},300)):i()}),s.on("keyup",function(){s.css({height:""});var e=s[0].scrollHeight;s.css({height:e}),e!=l&&(l=e,t.getRow().normalizeHeight())}),s},number:function(t,e,o,i,n){var r=$("<input type='number'/>");return r.css({padding:"4px",width:"100%","box-sizing":"border-box"}).val(t.getValue()),e(function(){r.focus(),r.css("height","100%")}),r.on("blur",function(e){var n=r.val();isNaN(n)||(n=Number(n)),n!=t.getValue()?o(n):i()}),r.on("keydown",function(t){var e;13==t.keyCode&&(e=r.val(),isNaN(e)||(e=Number(e)),o(e))}),r},star:function(t,e,o,i,n){var r=t.getElement(),a=t.getValue(),s=$("svg",r).length||5,l=$("svg:first",r).attr("width")||14,c=$("<div style='vertical-align:middle; padding:4px; display:inline-block; vertical-align:middle;'></div>"),u=$('<svg width="'+l+'" height="'+l+'" class="tabulator-star-active" viewBox="0 0 512 512" xml:space="preserve" style="padding:0 1px;"><polygon fill="#488CE9" stroke="#014AAE" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/></svg>'),d=$('<svg width="'+l+'" height="'+l+'" class="tabulator-star-inactive" viewBox="0 0 512 512" xml:space="preserve" style="padding:0 1px;"><polygon fill="#010155" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/></svg>'),p=function(t){$(".tabulator-star-active",t.closest("div")).length!=t.prevAll("svg").length+1&&(t.prevAll("svg").replaceWith(u.clone()),t.nextAll("svg").replaceWith(d.clone()),t.replaceWith(u.clone()))};a=parseInt(a)<s?parseInt(a):s;for(var g=1;g<=s;g++){var h=g<=a?u:d;c.append(h.clone())}return c.on("mouseover","svg",function(t){t.stopPropagation(),p($(this))}),c.on("mouseover",function(t){$("svg",$(this)).replaceWith(d.clone())}),c.on("click",function(t){o(0)}),c.on("click","svg",function(t){t.stopPropagation(),o($(this).prevAll("svg").length+1)}),r.css({"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}),r.on("blur",function(){i()}),r.on("keydown",function(t){switch(t.keyCode){case 39:p($(".tabulator-star-inactive:first",c));break;case 37:var e=$(".tabulator-star-active:last",c).prev("svg");e.length?p(e):$("svg",c).replaceWith(d.clone());break;case 13:o($(".tabulator-star-active",c).length)}}),c},progress:function(t,e,o,i,n){var r,a=t.getElement(),s=$("div",a).data("max"),l=$("div",a).data("min"),c=(s-l)/100,u=t.getValue()||0,d=$("<div class='tabulator-progress-handle' style='position:absolute; right:0; top:0; bottom:0; width:5px;'></div>"),p=function(){var t=c*Math.round(r.outerWidth()/(a.width()/100))+l;o(t),a.attr("aria-valuenow",t).attr("aria-label",u)};return u=parseFloat(u)<=s?parseFloat(u):s,u=parseFloat(u)>=l?parseFloat(u):l,u=100-Math.round((u-l)/c),r=$("<div style='position:absolute; top:8px; bottom:8px; left:4px; right:"+u+"%; margin-right:4px; background-color:#488CE9; display:inline-block; max-width:100%; min-width:0%;' data-max='"+s+"' data-min='"+l+"'></div>"),a.css({padding:"0 4px"}),a.attr("aria-valuemin",l).attr("aria-valuemax",s),r.append(d),d.on("mousedown",function(t){r.data("mouseDrag",t.screenX),r.data("mouseDragWidth",r.outerWidth())}),d.on("mouseover",function(){$(this).css({cursor:"ew-resize"})}),a.on("mousemove",function(t){r.data("mouseDrag")&&r.css({width:r.data("mouseDragWidth")+(t.screenX-r.data("mouseDrag"))})}),a.on("mouseup",function(t){r.data("mouseDrag")&&(t.stopPropagation(),t.stopImmediatePropagation(),r.data("mouseDragOut",!0),r.data("mouseDrag",!1),r.data("mouseDragWidth",!1),p())}),a.on("keydown",function(t){switch(t.keyCode){case 39:r.css({width:r.width()+a.width()/100});break;case 37:r.css({width:r.width()-a.width()/100});break;case 13:p()}}),a.on("blur",function(){i()}),r},tickCross:function(t,e,o,i,n){var r=t.getValue(),a=$("<input type='checkbox'/>");return a.css({"margin-top":"5px","box-sizing":"border-box"}).val(r),e(function(){a.focus()}),!0===r||"true"===r||"True"===r||1===r?a.prop("checked",!0):a.prop("checked",!1),a.on("change blur",function(t){o(a.is(":checked"))}),a.on("keydown",function(t){13==t.keyCode&&o(a.is(":checked"))}),a},tick:function(t,e,o,i,n){var r=t.getValue(),a=$("<input type='checkbox'/>");return a.css({"margin-top":"5px","box-sizing":"border-box"}).val(r),e(function(){a.focus()}),!0===r||"true"===r||"True"===r||1===r?a.prop("checked",!0):a.prop("checked",!1),a.on("change blur",function(t){o(a.is(":checked"))}),a.on("keydown",function(t){13==t.keyCode&&o(a.is(":checked"))}),a}},Tabulator.registerExtension("edit",Edit);