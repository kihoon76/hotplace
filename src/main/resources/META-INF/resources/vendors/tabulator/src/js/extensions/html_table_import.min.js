"use strict";var HtmlTableImport=function(t){this.table=t};HtmlTableImport.prototype.parseTable=function(){var t=this,e=t.table.element,a=t.table.options,r=(a.columns,$("th",e)),i=$("tbody tr",e),o=[];t.table.options.htmlImporting(),t._extractOptions(e,a),r.length?t._extractHeaders(e):t._generateBlankHeaders(e),i.each(function(t){var e={};e[a.index]=t,$("td",$(this)).each(function(t){e[$(this).data("field")]=$(this).html()}),o.push(e)});var l=$("<div></div>"),n=e.prop("attributes");$.each(n,function(){l.attr(this.name,this.value)}),e.replaceWith(l),a.data=o,t.table.options.htmlImported(),l.tabulator(a)},HtmlTableImport.prototype._extractOptions=function(t,e){var a=this,r=t[0].attributes;for(var i in r){var o,l=r[i];if(l&&l.name&&0===l.name.indexOf("tabulator-")){o=l.name.replace("tabulator-","");for(var n in e)n.toLowerCase()==o&&(e[n]=a._attribValue(l.value))}}},HtmlTableImport.prototype._attribValue=function(t){return"true"===t||"false"!==t&&t},HtmlTableImport.prototype._findCol=function(t){return this.table.options.columns.find(function(e){return e.title===t})||!1},HtmlTableImport.prototype._extractHeaders=function(t){var e=this,a=$("th",t),r=$("tbody tr",t);a.each(function(t){var a,i,o=$(this),l=!1,n=e._findCol(o.text()),s=["title","field","align","width","minWidth","frozen","sortable","sorter","formatter","cellClick","cellDblClick","cellContext","editable","editor","visible","cssClass","tooltip","tooltipHeader","editableTitle","headerFilter","mutator","mutateType","accessor"];n?l=!0:n={title:o.text().trim()},n.field||(n.field=o.text().trim().toLowerCase().replace(" ","_")),(a=o.attr("width"))&&!n.width&&(n.width=a),i=o[0].attributes;for(var d in i){var p,u=i[d];u&&u.name&&0===u.name.indexOf("tabulator-")&&(p=u.name.replace("tabulator-",""),s.forEach(function(t){t.toLowerCase()==p&&(n[t]=e._attribValue(u.value))}))}$("td:eq("+t+")",r).data("field",n.field),n.field==e.table.options.index&&(hasIndex=!0),l||e.table.options.columns.push(n)})},HtmlTableImport.prototype._generateBlankHeaders=function(t){var e=this;$("tr:first td",t).each(function(t){var a={title:"",field:"col"+t};$("td:eq("+t+")",rows).data("field",a.field);var r=$(this).attr("width");r&&(a.width=r),e.table.options.columns.push(a)})},Tabulator.registerExtension("htmlTableImport",HtmlTableImport);