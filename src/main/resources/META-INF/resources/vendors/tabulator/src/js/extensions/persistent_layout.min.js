"use strict";var PersistentLayout=function(t){this.table=t,this.mode="",this.id="",this.persistProps=["field","width","visible"]};PersistentLayout.prototype.initialize=function(t,e){this.mode=!0!==t?t:void 0!==window.localStorage?"local":"cookie",this.id="tabulator-"+(e||this.table.element.attr("id")||"")},PersistentLayout.prototype.load=function(t){var e="";switch(this.mode){case"local":e=localStorage.getItem(this.id);break;case"cookie":var i=document.cookie,o=i.indexOf(this.id+"="),s=void 0;o>-1&&((s=(i=i.substr(o)).indexOf(";"))>-1&&(i=i.substr(0,s)),e=i.replace(this.id+"=",""))}return e&&(e=JSON.parse(e),t=this.mergeDefinition(t,e)),t},PersistentLayout.prototype.mergeDefinition=function(t,e){var i=this,o=[];return e.forEach(function(e,s){var n=i._findColumn(t,e);n&&(n.width=e.width,n.visible=e.visible,n.columns&&(n.columns=i.mergeDefinition(n.columns,e.columns)),o.push(n))}),o},PersistentLayout.prototype._findColumn=function(t,e){var i=e.columns?"group":e.field?"field":"object";return t.find(function(t){switch(i){case"group":return t.title===e.title&&t.columns.length===e.columns.length;case"field":return t.field===e.field;case"object":return t===e}})},PersistentLayout.prototype.save=function(){var t=this.parseColumns(this.table.columnManager.getColumns()),e=JSON.stringify(t);switch(this.mode){case"local":localStorage.setItem(this.id,e);break;case"cookie":var i=new Date;i.setDate(i.getDate()+1e4),document.cookie=this.id+"="+e+"; expires="+i.toUTCString()}},PersistentLayout.prototype.parseColumns=function(t){var e=this,i=[];return t.forEach(function(t){var o={};t.isGroup?(o.title=t.getDefinition().title,o.columns=e.parseColumns(t.getColumns())):(o.title=t.getDefinition().title,o.field=t.getField(),o.width=t.getWidth(),o.visible=t.visible),i.push(o)}),i},Tabulator.registerExtension("persistentLayout",PersistentLayout);